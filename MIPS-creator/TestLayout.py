# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'TestLayout.ui'
#
# Created by: PyQt5 UI code generator 5.15.4
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


from PyQt5 import QtCore, QtGui, QtWidgets
from collapsibleBox import CollapsibleBox
from classes import *


class Test(QtWidgets.QWidget): 
    def __init__(self,index): 
        super(QtWidgets.QWidget, self).__init__() 
        self.name="Test - %s"%index
        self.index=index
        self.setupUi()

    def setupUi(self):
        self.setObjectName("test") 
        self.setMinimumWidth(725)
        self.verticalLayout = QtWidgets.QVBoxLayout(self) 
        self.verticalLayout.setObjectName("verticalLayout")
        self.verticalLayout.setSpacing(0)
        self.HidingBox=CollapsibleBox(self.name)
        self.verticalLayout.addWidget(self.HidingBox)
        self.TopRow=TestTopRow()
        self.TopRow.TestName.textChanged.connect(self.updateName)
        self.HidingBox.addWidget(self.TopRow)
        self.allUserInput=CollapsibleBox("User Input",self.HidingBox)
        self.DataInput=CollapsibleBox("Data Input",self.HidingBox)
        self.InputRegisters=CollapsibleBox("Input Registers",self.HidingBox)
        self.Outputs=CollapsibleBox("Output Registers",self.HidingBox)

        icon = QtGui.QIcon()
        icon.addPixmap(QtGui.QPixmap("Icons/add.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        
        text="   Add New"
        width=90
        AddButton1 = QtWidgets.QPushButton(text=text)
        AddButton1.setMaximumWidth(width)
        AddButton1.setIcon(icon)
        AddButton2 = QtWidgets.QPushButton(text=text)
        AddButton2.setMaximumWidth(width)
        AddButton2.setIcon(icon)
        AddButton3 = QtWidgets.QPushButton(text=text)
        AddButton3.setMaximumWidth(width)
        AddButton3.setIcon(icon)
        AddButton4 = QtWidgets.QPushButton(text=text)
        AddButton4.setMaximumWidth(width)
        AddButton4.setIcon(icon)
        
        
        AddButton1.pressed.connect(self.addUserInputRow)
        AddButton2.pressed.connect(self.addDataRow)
        AddButton3.pressed.connect(self.addRegisterRow)
        AddButton4.pressed.connect(self.addOutputRow)

        self.allUserInput.addWidget(AddButton1)
        self.DataInput.addWidget(AddButton2)
        self.InputRegisters.addWidget(AddButton3)
        self.Outputs.addWidget(AddButton4)
    
        


        self.verticalLayout.addStretch()
        self.retranslateUi() 
    #TODO make the add user input button work
    def addUserInputRow(self):
        row=UserInputRow(parent=self.allUserInput)
        row.Deleted.connect(self.rowDeleted)
    
    def addDataRow(self):
        row=DataRow(parent=self.DataInput)
        row.Deleted.connect(self.rowDeleted)
    
    def addRegisterRow(self):
        row=RegisterRow(parent=self.InputRegisters)
        row.Deleted.connect(self.rowDeleted)
    
    def addOutputRow(self):
        row=OutputRow(parent=self.Outputs)
        row.Deleted.connect(self.rowDeleted)
   
    def rowDeleted(self, row,box):
        box.updateHeight(row,Forward=False)

    def updateName(self, s):
        if s == "": s = "Test"
        self.HidingBox.toggle_button.setText("%s - %s"%(s,self.index))
        self.name=s


    def retranslateUi(self): 
        pass
         